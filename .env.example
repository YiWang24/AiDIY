# =================================================================
# Environment Variables Example
# =================================================================
# This file contains all environment variables used across:
# - CI/CD (GitHub Actions)
# - Frontend (Docusaurus)
# - Backend (KB API)
#
# For local development, copy this file to .env and fill in the values.
# For production, use Doppler to manage secrets securely.
#
# =================================================================
# QUICK START
# =================================================================
#
# 1. Copy this file to .env:
#    cp .env.example .env
#
# 2. Fill in the required values (marked with [REQUIRED])
#
# 3. Start the application:
#    ./scripts/dev-start.sh
#
# =================================================================

# =================================================================
# FRONTEND (Docusaurus) Configuration
# =================================================================

# Backend API Configuration
# The URL where the KB API is hosted
BACKEND_URL=https://api.yiw.me

# RAG Sync API Key
# Must match the backend RAG_SYNC_KEY for syncing documentation to vector database
RAG_SYNC_KEY=your_rag_sync_key_here

# Cloudflare Access Credentials (optional)
# Required if backend is protected by Cloudflare Access
CF_CLIENT_ID=your_cf_client_id
CF_CLIENT_SECRET=your_cf_client_secret

# RAG Sync Requirement
# Set to 'true' to fail the build if RAG sync fails (default: false)
RAG_SYNC_REQUIRED=false

# =================================================================
# BACKEND (KB API) Configuration
# =================================================================

# -----------------------------------------------------------------
# Database Configuration
# -----------------------------------------------------------------

# PostgreSQL connection string with pgvector extension
# Format: postgresql://user:password@host:port/database
DATABASE_URL=postgresql://postgres:password@localhost:5432/kb_db

# Enable pgvector extension (true/false)
PGVECTOR=true

# -----------------------------------------------------------------
# LLM Configuration
# -----------------------------------------------------------------

# Google Gemini API Key
# Get from: https://makersuite.google.com/app/apikey
GEMINI_API_KEY=your_gemini_api_key_here

# -----------------------------------------------------------------
# Web Search Configuration
# -----------------------------------------------------------------

# Tavily Search API Key (recommended for web search)
# Get from: https://tavily.com
TAVILY_API_KEY=tvly-your_tavily_key_here

# Brave Search API Key (alternative web search provider)
# Get from: https://api.search.brave.com/app/keys
BRAVE_API_KEY=your_brave_api_key_here

# -----------------------------------------------------------------
# Observability Configuration
# -----------------------------------------------------------------

# Sentry DSN for error tracking (optional)
# Get from: https://sentry.io/settings/projects/
SENTRY_DSN=https://your-sentry-dsn@sentry.io/project-id

# Sentry environment name
SENTRY_ENVIRONMENT=development

# -----------------------------------------------------------------
# Feature Flags
# -----------------------------------------------------------------

# Enable hybrid search (semantic + BM25 keyword search)
USE_HYBRID_SEARCH=true

# Enable reranking for improved retrieval quality
USE_RERANKING=true

# Enable web search fallback when KB has insufficient information
WEB_FALLBACK_ENABLED=true

# -----------------------------------------------------------------
# Performance Tuning
# -----------------------------------------------------------------

# Default number of chunks to retrieve (1-50)
TOP_K_DEFAULT=10

# Maximum context length for answer generation (characters)
MAX_CONTEXT_LENGTH=4000

# API server port (default: 8000)
PORT=8000

# Logging level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO

# =================================================================
# CI/CD Configuration (GitHub Actions)
# =================================================================

# -----------------------------------------------------------------
# Azure Container Registry (ACR)
# -----------------------------------------------------------------

# Azure Container Registry login server
# Format: <acr-name>.azurecr.io
ACR_LOGIN_SERVER=your-acr.azurecr.io

# Container repository name in ACR
ACR_REPOSITORY=kb-api

# ACR username
ACR_USERNAME=your_acr_username

# ACR password
ACR_PASSWORD=your_acr_password

# -----------------------------------------------------------------
# SSH Deployment Configuration
# -----------------------------------------------------------------

# Jump host (VPS) SSH configuration
# Used as SSH proxy to reach internal network
DEPLOY_SSH_HOST=your-vps.example.com
DEPLOY_SSH_USER=deploy
DEPLOY_SSH_PORT=22
# SSH private key (multi-line, use proper format in Doppler/GitHub Secrets)
DEPLOY_SSH_KEY="-----BEGIN OPENSSH PRIVATE KEY-----\n...\n-----END OPENSSH PRIVATE KEY-----"

# Internal server SSH configuration
# Target server behind jump host
INTERNAL_SSH_HOST=10.0.1.133
INTERNAL_SSH_USER=ubuntu
INTERNAL_SSH_PORT=22

# Deployment working directory on internal server
DEPLOY_WORKDIR=/opt/kb-api

# -----------------------------------------------------------------
# Doppler Configuration
# -----------------------------------------------------------------

# Doppler project name
DOPPLER_PROJECT=portfolio-api

# Doppler configuration for deployment (stg, prd, dev)
# For GitHub Actions: Use service token to read PRD config
DOPPLER_CONFIG=prd

# Doppler service token
# Create at: https://dash.doppler.com → Settings → Service Tokens
# Required for GitHub Actions to read Doppler secrets
DOPPLER_TOKEN=dp.x.your_service_token_here

# -----------------------------------------------------------------
# Health Check Configuration
# -----------------------------------------------------------------

# Health check URL for deployment verification
HEALTHCHECK_URL=https://your-api.example.com/health

# -----------------------------------------------------------------
# Code Quality Tools
# -----------------------------------------------------------------

# Codecov token for coverage reporting (optional)
# Get from: https://codecov.io/gh/YOUR_ORG/YOUR_REPO
CODECOV_TOKEN=your_codecov_token_here

# Sentry authentication token for release tracking (optional)
SENTRY_AUTH_TOKEN=your_sentry_auth_token_here
SENTRY_ORG=your-sentry-org
SENTRY_PROJECT=kb-api

# =================================================================
# NOTES
# =================================================================

# Security Best Practices:
# 1. Never commit actual secrets to git
# 2. Use Doppler for production secrets: https://doppler.com
# 3. Use GitHub Secrets for CI/CD: https://github.com/YOUR_ORG/YOUR_REPO/settings/secrets
# 4. Rotate secrets regularly
# 5. Use different API keys for dev/stg/prd environments

# Environment Variable Precedence (highest to lowest):
# 1. Command line flags
# 2. Shell environment variables
# 3. .env file (when using tools like python-dotenv)
# 4. Default values in code

# For Local Development:
# - Copy this file to .env
# - Fill in DATABASE_URL, GEMINI_API_KEY, TAVILY_API_KEY
# - Run: ./scripts/dev-start.sh

# For Production Deployment:
# - Configure all secrets in Doppler (prd config)
# - Configure CI/CD secrets in Doppler (stg config)
# - Sync stg secrets to GitHub Secrets
# - Push to main branch to trigger deployment
